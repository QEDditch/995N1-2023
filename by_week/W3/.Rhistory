---
title: "Data visualisation (computer session)"
author: "Daniele Rotolo"
date: "Introductory Data Science for Innovation (995N1) -- Weeks 3, 11 October 2021"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(tidyverse)
library(GGally)
library(gghighlight)
library(patchwork)
my_data <- read_csv("scoreboard_firms_pharma_healthcare.csv")
ggplot(data = my_data, aes(isocountrycode)) +
geom_histogram(stat = "count", color = "white",
fill = "blue", binwidth = 1, alpha = 0.4) +
ggtitle("Firms by country") +
xlab("country") + ylab("number of firms")
ggplot(data = my_data, aes(rd2015)) +
geom_density(color = "white", fill = "blue", alpha = 0.4) +
ggtitle("Density plot of 2015 R&D investment")
ggplot(data = my_data, aes(rd2015)) +
geom_density(color = "white", fill = "blue", alpha = 0.4) +
scale_x_log10() +
ggtitle("Density plot of 2015 R&D investment") +
xlab("R&D investment 2015 (log scale)")
ggplot(data = my_data, aes(pubs.2015)) +
geom_density(color = "white", fill = "blue", alpha = 0.4) +
scale_x_log10() +
ggtitle("Density plot of 2015 R&D investment") +
xlab("R&D investment 2015 (log scale)")
my_data_rd <- my_data %>%
select(ID, rd2011, rd2012, rd2013, rd2014, rd2015) %>%
pivot_longer(-ID, names_to = "year", values_to = "rd")
head(my_data_rd)
ggplot(data = my_data_rd, aes(rd)) +
geom_density(color = "white", fill = "blue", alpha = 0.4) +
scale_x_log10() +
ggtitle("Density plot of R&D investment (2011-2015)") +
xlab("R&D (log scale)")
ggplot(data = my_data_rd, aes(rd, fill = year)) +
geom_density(color = "white", position = "identity", alpha = 0.4) +
scale_x_log10() +
ggtitle("Density plot of R&D investment (2011-2015)") +
xlab("R&D (log scale)")
---
title: "Data visualisation (computer session)"
author: "Daniele Rotolo"
date: "Introductory Data Science for Innovation (995N1) -- Weeks 3, 11 October 2021"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(tidyverse)
library(GGally)
library(gghighlight)
library(patchwork)
my_data <- read_csv("scoreboard_firms_pharma_healthcare.csv")
ggplot(data = my_data, aes(isocountrycode)) +
geom_histogram(stat = "count", color = "white",
fill = "blue", binwidth = 1, alpha = 0.4) +
ggtitle("Firms by country") +
xlab("country") + ylab("number of firms")
rm(list=ls())
library(tidyverse)
library(GGally)
library(gghighlight)
library(patchwork)
my_data <- read_csv("scoreboard_firms_pharma_healthcare.csv")
View(my_data)
ggplot(data = my_data, aes(isocountrycode)) +
geom_histogram(stat = "count", color = "white",
fill = "blue", binwidth = 1, alpha = 0.4) +
ggtitle("Firms by country") +
xlab("country") + ylab("number of firms")
ggplot(data = my_data, aes(rd2015)) +
geom_density(color = "white", fill = "blue", alpha = 0.4) +
ggtitle("Density plot of 2015 R&D investment")
ggplot(data = my_data, aes(rd2015)) +
geom_density(color = "white", fill = "blue", alpha = 0.4) +
scale_x_log10() +
ggtitle("Density plot of 2015 R&D investment") +
xlab("R&D investment 2015 (log scale)")
my_data_rd <- my_data %>%
select(ID, rd2011, rd2012, rd2013, rd2014, rd2015) %>%
pivot_longer(-ID, names_to = "year", values_to = "rd")
head(my_data_rd)
ggplot(data = my_data_rd, aes(rd)) +
geom_density(color = "white", fill = "blue", alpha = 0.4) +
scale_x_log10() +
ggtitle("Density plot of R&D investment (2011-2015)") +
xlab("R&D (log scale)")
ggplot(data = my_data_rd, aes(rd, fill = year)) +
geom_density(color = "white", position = "identity", alpha = 0.4) +
scale_x_log10() +
ggtitle("Density plot of R&D investment (2011-2015)") +
xlab("R&D (log scale)")
View(my_data_rd)
my_data_rd <- my_data %>%
select(ID, rd2011:rd2015) %>%
pivot_longer(-ID, names_to = "year", values_to = "rd") %>%
mutate(year = gsub("rd", "", year))
View(my_data_rd)
head(my_data)
my_data_rd <- my_data %>%
select(ID, rd2011:rd2015) %>%
pivot_longer(-ID, names_to = "year", values_to = "rd") %>%
mutate(year = gsub("rd", "", year))
my_data_ns <- my_data %>%
select(ID, ns2011:ns2015) %>%
pivot_longer(-ID, names_to = "year", values_to = "ns") %>%
mutate(year = gsub("ns", "", year))
my_data_emp <- my_data %>%
select(ID, emp2011:emp2015) %>%
pivot_longer(-ID, names_to = "year", values_to = "emp") %>%
mutate(year = gsub("emp", "", year))
my_data_pub <- my_data %>%
select(ID, pubs.2011:pubs.2015) %>%
pivot_longer(-ID, names_to = "year", values_to = "pubs") %>%
mutate(year = gsub("pubs.", "", year))
my_data_tidy <- my_data_rd %>%
full_join(., my_data_ns, by = c("ID", "year")) %>%
full_join(., my_data_emp, by = c("ID", "year")) %>%
full_join(., my_data_pub, by = c("ID", "year")) %>%
full_join(., my_data %>% select(ID, isocountrycode), by = c("ID"))
head(my_data_tidy)
ggpairs(my_data_tidy, aes(color = year),
columns = c("rd", "ns", "emp", "pubs"))
my_data_tidy <- my_data_tidy %>%
mutate(country = ifelse(isocountrycode != "US" &
isocountrycode != "CN" &
isocountrycode != "JP" &
isocountrycode != "DE" &
isocountrycode != "GB", "Other", isocountrycode))
ggplot(data = my_data_tidy, aes(x = rd, y = pubs+1)) +
geom_point(aes(color = country,  size = emp)) +
scale_size(range = c(0, 3)) +
geom_smooth() +
scale_x_log10() +
scale_y_log10() +
ggtitle("R&D investment and publications (2011-2015)") +
xlab("R&D (log scale)") +
ylab("Number of publications (log scale)") +
theme(legend.position = "bottom")
ggplot(data = my_data_tidy, aes(x = rd, y = pubs+1)) +
geom_point(aes(color = country,  size = emp)) +
scale_size(range = c(0, 3)) +
geom_smooth() +
scale_x_log10() +
scale_y_log10() +
ggtitle("R&D investment and publications (2011-2015) - <10,000 employees") +
xlab("R&D (log scale)") +
ylab("Number of publications") +
gghighlight(emp < 10000, keep_scales = T)
ggplot(data = my_data_tidy, aes(x = rd, y = pubs+1)) +
geom_point(aes(color = country,  size = emp)) +
scale_size(range = c(0, 3)) +
geom_smooth() +
scale_x_log10() +
scale_y_log10() +
ggtitle("R&D investment and publications (2011-2015) - 10,000-50,000 employees") +
xlab("R&D (log scale)") +
ylab("Number of publications") +
gghighlight(emp >= 10000 & emp <= 50000, keep_scales = T)
ggplot(data = my_data_tidy, aes(x = rd, y = pubs+1)) +
geom_point(aes(color = country,  size = emp)) +
scale_size(range = c(0, 3)) +
geom_smooth() +
scale_x_log10() +
scale_y_log10() +
ggtitle("R&D investment and publications (2011-2015) - >50,000 employees") +
xlab("R&D (log scale)") +
ylab("Number of publications") +
gghighlight(emp > 50000, keep_scales = T)
g1 / (g2 + g3 + g4) + plot_annotation(tag_levels = 'A')
g1 <- ggplot(data = my_data_tidy, aes(x = rd, y = pubs+1)) +
geom_point(aes(color = country,  size = emp)) +
scale_size(range = c(0, 3)) +
geom_smooth() +
scale_x_log10() +
scale_y_log10() +
ggtitle("R&D investment and number of publications (2011-2015)") +
xlab("R&D (log scale)") +
ylab("Number of publications") +
theme(legend.position = "bottom")
g2 <- g1 +
theme(legend.position = "none",
plot.title = element_text(size = 7)) +
ggtitle("<10,000 employees") +
gghighlight(emp < 10000, keep_scales = T)
g3 <- g1 +
theme(legend.position = "none",
plot.title = element_text(size = 7)) +
ggtitle("10,000-50,000 employees") +
gghighlight(emp >= 10000 & emp <= 50000, keep_scales = T)
g4 <- g1 +
theme(legend.position = "none",
plot.title = element_text(size = 7)) +
ggtitle(">50,000 employees") +
gghighlight(emp > 50000, keep_scales = T)
g1 / (g2 + g3 + g4) + plot_annotation(tag_levels = 'A')
ggplot(data = my_data_tidy, aes(x = rd, y = pubs+1)) +
geom_point(aes(color = country,  size = emp)) +
scale_size(range = c(0, 3)) +
geom_smooth() +
scale_x_log10() +
scale_y_log10() +
ggtitle("R&D investment and number of publications (2011-2015)") +
xlab("R&D (log scale)") +
ylab("Number of publications") +
theme(legend.position = "bottom") +
facet_wrap(~country)
ggplot(data = my_data_tidy, aes(x = rd, y = pubs+1)) +
geom_point(aes(color = country,  size = emp)) +
scale_size(range = c(0, 3)) +
geom_smooth() +
scale_x_log10() +
scale_y_log10() +
ggtitle("R&D investment and number of publications (2011-2015)") +
xlab("R&D (log scale)") +
ylab("Number of publications") +
theme(legend.position = "bottom") +
facet_wrap(~year)
