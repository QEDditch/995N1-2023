install.packages("tidytext")
install.packages("textdata")
install.packages(c("gert", "readr", "vroom"))
install.packages("reshape2")
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(plotly)
library(igraph)
library(ggraph)
my_text_uni <- read_csv("news_articles_example.csv") %>%
filter(`Published date` == "December 1, 2020 Tuesday") %>%
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
my_text_uni
my_text_uni <- my_text_uni %>%
mutate(id = paste0("doc", id))
node1 <- my_text_uni %>%
distinct(id) %>%
rename(node = id) %>%
mutate(type = T)
node2 <- my_text_uni %>%
distinct(word) %>%
rename(node = word) %>%
mutate(type = F)
nodes <- bind_rows(node1, node2)
nodes
g_bip <- graph_from_data_frame(my_text_uni, vertices = nodes, directed = F)
g_bip
print(g_bip_vis)
g_bip_vis <- ggraph(g_bip, layout = "stress") +
geom_edge_link0(edge_colour = "grey") +
geom_node_point(aes(shape = type, color =  type), size = 2.5) +
theme_graph()
print(g_bip_vis)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(plotly)
library(igraph)
library(ggraph)
my_text_uni <- read_csv("news_articles_example.csv") %>%
filter(`Published date` == "December 1, 2020 Tuesday") %>%
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
my_text_uni
my_text_uni <- my_text_uni %>%
mutate(id = paste0("doc", id))
node1 <- my_text_uni %>%
distinct(id) %>%
rename(node = id) %>%
mutate(type = T)
node2 <- my_text_uni %>%
distinct(word) %>%
rename(node = word) %>%
mutate(type = F)
nodes <- bind_rows(node1, node2)
View(nodes)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(plotly)
library(igraph)
library(ggraph)
my_text_uni <- read_csv("news_articles_example.csv") %>%
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(plotly)
library(igraph)
library(ggraph)
my_text_uni <- read_csv("news_articles_example.csv") %>%
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
my_text_uni
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(plotly)
library(igraph)
library(ggraph)
my_text_uni <- read_csv("news_articles_example.csv")
my_text_uni <- read_csv("news_articles_example.csv")
View(my_text_uni)
table(my_text_uni$Publication)
my_text_uni <- read_csv("news_articles_example.csv") %>%
filter(Publication == "The Guardian (London)" |
Publication == "The New York Times" |
Publication == "The Independent (United Kingdom)")
my_text_uni <- read_csv("news_articles_example.csv") %>%
filter(Publication == "The Guardian (London)" |
Publication == "The New York Times" |
Publication == "The Independent (United Kingdom)")
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
my_text_uni <- read_csv("news_articles_example.csv") %>%
filter(Publication == "The Guardian (London)" |
Publication == "The New York Times" |
Publication == "The Independent (United Kingdom)") %>%
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
my_text_uni
my_text_uni <- my_text_uni %>%
mutate(id = paste0("doc", id))
node1 <- my_text_uni %>%
distinct(id) %>%
rename(node = id) %>%
mutate(type = T)
node2 <- my_text_uni %>%
distinct(word) %>%
rename(node = word) %>%
mutate(type = F)
nodes <- bind_rows(node1, node2)
nodes
g_bip <- graph_from_data_frame(my_text_uni, vertices = nodes, directed = F)
g_bip
g_bip_vis <- ggraph(g_bip, layout = "stress") +
geom_edge_link0(edge_colour = "grey") +
geom_node_point(aes(shape = type, color =  type), size = 2.5) +
theme_graph()
print(g_bip_vis)
g <- bipartite_projection(g_bip, multiplicity = T, which = F)
g <- delete.edges(g, which(E(g)$weight == 1))
g <- decompose.graph(g)[[1]]
V(g)$size <- degree(g)
g
g_vis <- ggraph(g, layout = "stress") +
geom_edge_link0(aes(edge_width = weight), edge_colour = "grey66") +
geom_node_point(aes(size = size), fill = "lightblue", colour = "white", shape = 21) +
geom_node_text(aes(label = name), size = 2.5) +
scale_edge_width(range = c(0.5, 3)) +
scale_size(range = c(1, 10)) +
theme_graph()
print(g_vis)
g <- bipartite_projection(g_bip, multiplicity = T, which = F)
g <- decompose.graph(g)[[1]]
V(g)$size <- degree(g)
g
g_vis <- ggraph(g, layout = "stress") +
geom_edge_link0(aes(edge_width = weight), edge_colour = "grey66") +
geom_node_point(aes(size = size), fill = "lightblue", colour = "white", shape = 21) +
geom_node_text(aes(label = name), size = 2.5) +
scale_edge_width(range = c(0.5, 3)) +
scale_size(range = c(1, 10)) +
theme_graph()
print(g_vis)
w1 <- c(1, 0, 0, 0, 2)
w2 <- c(1, 0, 1, 0, 1)
w3 <- c(0, 0, 3, 0, 1)
lsa::cosine(w1, w2)
lsa::cosine(w1, w3)
my_text_uni <-  my_text_uni %>%
count(id, word) %>%
cast_dtm(id, word, n)
my_text_uni
my_text_uni <- lsa::cosine(as.matrix(my_text_uni))
g_cos <- graph_from_adjacency_matrix(my_text_uni, mode = "undirected", weighted = T)
g_cos <- delete.edges(g_cos, which(E(g_cos)$weight < 0.3))
g_cos <- decompose.graph(g_cos)[[1]]
g_cos
g_vis <- ggraph(g_cos, layout = "stress") +
geom_edge_link0(aes(edge_width = weight), edge_colour = "grey66") +
geom_node_point(fill = "lightblue", colour = "white", shape = 21) +
geom_node_text(aes(label = name), size = 2.5) +
scale_edge_width(range = c(0.01, 0.1)) +
scale_size(range = c(1, 10)) +
theme_graph()
g_vis <- ggraph(g_cos, layout = "stress") +
geom_edge_link0(aes(edge_width = weight), edge_colour = "grey66") +
geom_node_point(fill = "lightblue", colour = "white", shape = 21) +
geom_node_text(aes(label = name), size = 2.5) +
scale_edge_width(range = c(0.01, 0.1)) +
scale_size(range = c(1, 10)) +
theme_graph()
print(g_vis)
my_text_uni <- read_csv("news_articles_example.csv") %>%
mutate(all_text = paste(Title, Headline, Hlead, sep = " ")) %>%
select(id, all_text) %>%
unnest_tokens(output = word, input = all_text) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(plotly)
library(igraph)
library(ggraph)
my_text_uni <- read_csv("news_articles_example.csv") %>%
filter(Publication == "The Guardian (London)" |
Publication == "The New York Times" |
Publication == "The Independent (United Kingdom)") %>%
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
my_text_uni
my_text_uni <- my_text_uni %>%
mutate(id = paste0("doc", id))
node1 <- my_text_uni %>%
distinct(id) %>%
rename(node = id) %>%
mutate(type = T)
node2 <- my_text_uni %>%
distinct(word) %>%
rename(node = word) %>%
mutate(type = F)
nodes <- bind_rows(node1, node2)
nodes
g_bip <- graph_from_data_frame(my_text_uni, vertices = nodes, directed = F)
g_bip
g_bip_vis <- ggraph(g_bip, layout = "stress") +
geom_edge_link0(edge_colour = "grey") +
geom_node_point(aes(shape = type, color =  type), size = 2.5) +
theme_graph()
print(g_bip_vis)
my_text_uni <- read_csv("news_articles_example.csv") %>%
filter(Publication == "The Guardian (London)" |
Publication == "The New York Times" |
Publication == "The Independent (United Kingdom)") %>%
select(id, Title) %>%
unnest_tokens(output = word, input = Title) %>%
anti_join(stop_words) %>%
mutate(word_numeric = as.numeric(word)) %>%
filter(is.na(word_numeric)) %>%
select(-word_numeric)
my_text_uni
